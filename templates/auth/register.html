{% extends "base/base.html" %}

{% block content %}
<div class="row justify-content-center mt-5">
    <div class="col-md-6">
        <div class="card shadow">
            <div class="card-body p-5">
                <h2 class="text-center mb-4">
                    <i class="bi bi-person-plus"></i> Create Account
                </h2>
                <form method="POST">
                    <div class="mb-3">
                        <label for="email" class="form-label">UC Merced Email</label>
                        <input type="email" id="email" name="email" class="form-control" placeholder="youremail@ucmerced.edu" required>
                        <small class="text-muted">Must be a @ucmerced.edu email</small>
                    </div>
                    <div class="mb-3">
                        <label for="password" class="form-label">Password</label>
                        <input type="password" id="password" name="password" class="form-control" minlength="6" required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="role" class="form-label">I am a:</label>
                        <select id="role" name="role" class="form-select" required onchange="toggleAdminField()">
                            <option value="">Select role...</option>
                            <option value="student">Student</option>
                            <option value="club">Club Officer</option>
                            <option value="admin">Admin</option>
                        </select>
                    </div>

                    <div class="mb-3" id="admin-code-box" style="display: none;">
                        <label for="admin_code" class="form-label text-danger fw-bold">Admin Passcode</label>
                        <input type="password" id="admin_code" name="admin_code" class="form-control" placeholder="Enter secure code...">
                    </div>

                    <button type="submit" class="btn btn-primary w-100">
                        <i class="bi bi-person-check"></i> Register
                    </button>
                </form>
                <div class="text-center mt-3">
                    <small>Already have an account? <a href="{{ url_for('auth.login') }}">Login here</a></small>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function toggleAdminField() {
        var roleSelect = document.getElementById("role");
        var adminBox = document.getElementById("admin-code-box");
        var adminInput = document.getElementById("admin_code");

        if (roleSelect.value === "admin") {
            adminBox.style.display = "block";
            adminInput.required = true;
        } else {
            adminBox.style.display = "none";
            adminInput.required = false;
            adminInput.value = ""; // Clear it if they switch back
        }
    }
</script>
{% endblock %}